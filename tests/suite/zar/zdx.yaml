script: |
  mkdir logs
  zar import -q -s 2500B -R ./logs babble.tzng
  zar mkdirs -R ./logs
  # make an index by hand for each log containing a sum
  zar zq -R ./logs -o tmp.zng "sum(v) by s | put key=s | sort key" _
  # turn each custom key file into a b-tere index
  zar zdx -R ./logs -f 500 -o index tmp.zng
  ls logs/*/*/index.1.zng | sort
  echo ===
  zq -t logs/20200421/1587513208.06466306.zng.zar/index.1.zng

inputs:
  - name: babble.tzng
    source: ../zdx/babble.tzng

outputs:
  - name: stdout
    data: |
      logs/20200421/1587508830.06852324.zng.zar/index.1.zng
      logs/20200421/1587509666.06371639.zng.zar/index.1.zng
      logs/20200421/1587510340.06376481.zng.zar/index.1.zng
      logs/20200421/1587511070.06294938.zng.zar/index.1.zng
      logs/20200421/1587511703.06774599.zng.zar/index.1.zng
      logs/20200421/1587512398.0689091.zng.zar/index.1.zng
      logs/20200421/1587513208.06466306.zng.zar/index.1.zng
      logs/20200422/1587513965.0662909.zng.zar/index.1.zng
      logs/20200422/1587514781.06104719.zng.zar/index.1.zng
      logs/20200422/1587515638.06653301.zng.zar/index.1.zng
      logs/20200422/1587516408.06648763.zng.zar/index.1.zng
      logs/20200422/1587517144.06969796.zng.zar/index.1.zng
      logs/20200422/1587517919.0642989.zng.zar/index.1.zng
      ===
      #0:record[key:string,_btree_child:int64]
      0:[Auriga-teat;0;]
      0:[algesthesis-unkindred;539;]
      0:[colonopexy-ketonimin;1042;]
      0:[gangliac-cuspule;1548;]
      0:[nephratonia-subdeltoid;2074;]
      0:[ratiocinant-unmoaned;2610;]
      0:[sniggoringly-craniography;3142;]
      0:[veridically-coelenterate;3651;]
