# This test uses a version of conn.log that can be found at the root of
# the zq repository converted with SuperCowTools ZAT:
# https://github.com/SuperCowPowers/zat
# The typing support is pretty basic, this should be augmented with
# more complete unit tests...

script: |
  zq -t -i parquet conn.parquet

inputs:
  - name: conn.parquet

outputs:
  - name: stdout
    data: |
      #0:record[Ts:int64,Uid:string,Id_orig_h:string,Id_orig_p:int32,Id_resp_h:string,Id_resp_p:int32,Proto:string,Service:string,Duration:float64,Orig_bytes:int64,Resp_bytes:int64,Conn_state:string,Local_orig:bool,Local_resp:bool,Missed_bytes:int64,History:string,Orig_pkts:int64,Orig_ip_bytes:int64,Resp_pkts:int64,Resp_ip_bytes:int64,Tunnel_parents:string]
      0:[0;C8Tful1TvM3Zf5x8fl;10.164.94.120;39681;10.47.3.155;3389;tcp;\u002d;0.004265999887138605;97;19;RSTR;-;-;0;ShADTdtr;10;730;6;342;\u002d;]
      0:[0;CXWfTK3LRdiuQxBbM6;10.47.25.80;50817;10.128.0.218;23189;tcp;\u002d;0.00048600000445730984;0;0;REJ;-;-;0;Sr;2;104;2;80;\u002d;]
      0:[0;CM59GGQhNEoKONb5i;10.47.25.80;50817;10.128.0.218;23189;tcp;\u002d;0.0005380000220611691;0;0;REJ;-;-;0;Sr;2;104;2;80;\u002d;]
      0:[0;CuKFds250kxFgkhh8f;10.47.25.80;50813;10.128.0.218;27765;tcp;\u002d;0.0005460000247694552;0;0;REJ;-;-;0;Sr;2;104;2;80;\u002d;]
      0:[0;CBrzd94qfowOqJwCHa;10.47.25.80;50813;10.128.0.218;27765;tcp;\u002d;0.0006050000083632767;0;0;REJ;-;-;0;Sr;2;104;2;80;\u002d;]
      0:[0;CFzn9A3l9ppbMBVin3;10.164.94.120;40659;10.47.8.208;3389;tcp;\u002d;0.011921999976038933;147;19;RSTR;-;-;0;ShADTdtr;10;830;6;342;\u002d;]
      0:[0;CRrrfM193OOsonmOE8;10.164.94.120;36631;10.47.8.208;3389;tcp;\u002d;0.013515999540686607;71;19;RSTR;-;-;0;ShADTdtr;10;678;6;342;\u002d;]
      0:[0;CD3zwQ1YDr4XiQzO1e;10.128.0.207;59777;10.47.28.6;443;tcp;\u002d;0.0000019999999949504854;0;0;S0;-;-;0;S;2;88;0;0;\u002d;]
      0:[0;CxiF5o3CkvQUpKepTa;10.128.0.207;59777;172.20.0.6;443;tcp;\u002d;0.0000019999999949504854;0;0;S0;-;-;0;S;2;88;0;0;\u002d;]
      0:[0;CUY7Pc4Y1x1AUZ81ri;10.164.94.120;35691;10.47.27.80;8080;tcp;\u002d;0.0000009999999974752427;0;0;RSTOS0;-;-;0;R;2;104;0;0;\u002d;]
      0:[0;C4RZ6d4r5mJHlSYFI6;10.164.94.120;33299;10.47.3.200;80;tcp;\u002d;0.0030769999139010906;0;235;RSTO;-;-;0;^dtfAR;4;208;4;678;\u002d;]
      0:[0;CL31Wl4WQoDATEz5Z8;10.164.94.120;34261;10.47.8.208;3389;tcp;\u002d;0.004093000199645758;128;19;RSTRH;-;-;0;^dtADTr;4;464;4;222;\u002d;]
      0:[0;CP4gKa4ygOnhnLdjdd;10.128.0.207;59778;10.47.24.254;443;tcp;\u002d;0.0000019999999949504854;0;0;S0;-;-;0;S;2;88;0;0;\u002d;]
      0:[0;CnKmhv4RfyAZ3fVc8b;10.164.94.120;36125;10.47.3.200;80;tcp;\u002d;0.0000019999999949504854;0;0;RSTOS0;-;-;0;R;2;104;0;0;\u002d;]
      0:[0;CWai2s3n3tZvo7k4Lj;10.174.251.215;33017;10.47.6.53;443;tcp;\u002d;0.0010730000212788582;0;0;REJ;-;-;0;Sr;2;88;2;80;\u002d;]
      0:[0;C65IMkEAWNlE1f6L8;10.164.94.120;45941;10.47.3.200;80;tcp;\u002d;0.002707999898120761;0;242;RSTO;-;-;0;^dtfAR;4;208;4;692;\u002d;]
      0:[0;C86RjLOtyuRG30Kmc;10.174.251.215;33004;10.47.6.53;389;tcp;\u002d;0.000003000000106112566;0;0;S0;-;-;0;S;2;88;0;0;\u002d;]
      0:[0;C902zq4FwlacgucYVi;10.174.251.215;33004;10.47.23.25;5000;tcp;\u002d;0.000003000000106112566;0;0;S0;-;-;0;S;2;88;0;0;\u002d;]
      0:[0;CG8QYP7Ftz4EJ79Sh;10.174.251.215;33004;10.47.2.208;1028;tcp;\u002d;0.0000019999999949504854;0;0;S0;-;-;0;S;2;88;0;0;\u002d;]
      0:[0;CpQfkTi8xytq87HW2;10.164.94.120;36729;10.47.3.200;80;tcp;http;0.006238000001758337;325;263;RSTO;-;-;0;ShADTdftR;10;1186;6;854;\u002d;]
      0:[0;CpjMvj2Cvj048u6bF1;10.164.94.120;39169;10.47.3.200;80;tcp;http;0.0071390001103281975;315;241;RSTO;-;-;0;ShADTdtfR;10;1166;6;810;\u002d;]
      0:[0;CbNAoA1oLI0D2248Y3;10.174.251.215;33003;10.47.21.80;4899;tcp;\u002d;0.0000009999999974752427;0;0;S0;-;-;0;S;2;88;0;0;\u002d;]
      0:[0;CUJdrE4wh30Ue8irxh;10.174.251.215;33003;10.47.3.208;8008;tcp;\u002d;0.000003000000106112566;0;0;S0;-;-;0;S;2;88;0;0;\u002d;]
      0:[0;CsBRR72KWYc3My4Bh6;10.128.0.207;59778;10.47.27.254;443;tcp;\u002d;0.0000019999999949504854;0;0;S0;-;-;0;S;2;88;0;0;\u002d;]
      0:[0;C1aWzj2K8GCHnWMHsi;10.128.0.207;59778;10.47.30.254;443;tcp;\u002d;0.004364000167697668;0;0;S0;-;-;0;S;80;3520;0;0;\u002d;]
      0:[0;CTkOwC1e2L94irlRq9;10.128.0.207;59778;10.47.31.254;443;tcp;\u002d;0.0041149999015033245;0;0;S0;-;-;0;S;74;3256;0;0;\u002d;]
      0:[0;CgKOCuqEMf4NhqAsa;10.174.251.215;33004;10.47.6.20;8008;tcp;\u002d;0.000003000000106112566;0;0;S0;-;-;0;S;2;88;0;0;\u002d;]
      0:[0;C9Fdkr4XYwv6c3n7ha;10.174.251.215;33005;10.47.6.20;8443;tcp;\u002d;0.00020799999765586108;0;0;S0;-;-;0;S;2;88;0;0;\u002d;]
      0:[0;CnFmdMZSKTXqbjZZ5;10.128.0.207;59777;10.47.20.9;443;tcp;\u002d;0.000006000000212225132;0;0;S0;-;-;0;S;2;88;0;0;\u002d;]
      0:[0;CKq5kC3Y1Cts97eJ28;10.164.94.120;37797;10.47.3.200;80;tcp;http;0.004714000038802624;316;242;RSTO;-;-;0;ShADTdtfR;10;1168;6;812;\u002d;]
      0:[0;CiRc6r2wB1v1RaSu44;10.164.94.120;42011;10.47.27.80;443;tcp;\u002d;0.0000009999999974752427;0;0;RSTOS0;-;-;0;R;2;104;0;0;\u002d;]
      0:[0;C6TFga1FPIJC8ltoek;10.164.94.120;44749;10.47.8.208;3389;tcp;\u002d;0.014550999738276005;147;19;RSTR;-;-;0;ShADTdtr;10;830;6;342;\u002d;]
      0:[0;CPYJYO3zFH8aoVTNI5;10.164.94.120;34843;10.47.8.1;443;tcp;\u002d;0.00004999999873689376;0;0;RSTOS0;-;-;0;R;2;104;0;0;\u002d;]
      0:[0;CnvVFp2TmayGRljLS7;10.174.251.215;33003;10.47.23.25;1028;tcp;\u002d;0.0000019999999949504854;0;0;S0;-;-;0;S;2;88;0;0;\u002d;]
      0:[0;CjzrFi3Xl2xVoc22sk;10.174.251.215;33003;10.47.6.53;544;tcp;\u002d;0.0000009999999974752427;0;0;S0;-;-;0;S;2;88;0;0;\u002d;]
      0:[0;CzGQAAvWx6YAk4hn4;10.128.0.207;59778;10.47.29.255;443;tcp;\u002d;0.00420599989593029;0;0;S0;-;-;0;S;78;3432;0;0;\u002d;]
      0:[0;C6urJ12NjRnq8ofXZ4;10.164.94.120;37869;10.47.3.200;80;tcp;http;0.00910400040447712;319;245;RSTO;-;-;0;ShADTdtfR;10;1174;6;818;\u002d;]
      0:[0;CkozYQ2t3Kz102wyug;10.128.0.207;59777;10.47.27.9;443;tcp;\u002d;0.0000019999999949504854;0;0;S0;-;-;0;S;2;88;0;0;\u002d;]
      0:[0;CnBGgN284LgSkdbUY1;10.164.94.120;45517;10.47.27.80;8080;tcp;http;0.025419000536203384;362;1382;RSTO;-;-;0;ShADTdtR;10;1260;4;2988;\u002d;]
      0:[0;CF35Ub1rquuzRhy779;10.174.251.215;33004;10.47.6.51;389;tcp;\u002d;0.000003999999989900971;0;0;S0;-;-;0;S;2;88;0;0;\u002d;]
      0:[0;CD2mIC2DGysUXSIun8;10.174.251.215;33004;10.47.25.1;543;tcp;\u002d;0.0000019999999949504854;0;0;S0;-;-;0;S;2;88;0;0;\u002d;]
      0:[0;C9dWbz4Yj7wzvUeEH2;10.174.251.215;33004;10.47.6.52;5432;tcp;\u002d;0.0000009999999974752427;0;0;S0;-;-;0;S;2;88;0;0;\u002d;]
      0:[0;CheDTj5IA6NC345c;10.174.251.215;33003;10.47.25.80;49153;tcp;\u002d;0.000003000000106112566;0;0;S0;-;-;0;S;2;88;0;0;\u002d;]
      0:[0;CGQWdG2D15JNrsqy5d;10.174.251.215;33004;10.47.5.208;544;tcp;\u002d;0.000003000000106112566;0;0;S0;-;-;0;S;2;88;0;0;\u002d;]
      0:[0;CLf4jF4FNjpPUGHWT7;10.174.251.215;33003;10.47.24.1;544;tcp;\u002d;0.000003000000106112566;0;0;S0;-;-;0;S;2;88;0;0;\u002d;]
      0:[0;CyQd5IBOpQ3LgDhC3;10.174.251.215;33003;10.47.6.208;10000;tcp;\u002d;0.000003000000106112566;0;0;S0;-;-;0;S;2;88;0;0;\u002d;]
      0:[0;C9zBQP1nnfBHxUTEY1;10.164.94.120;39611;10.47.3.200;443;tcp;ssl;0.02213899977505207;739;1734;RSTO;-;-;0;ShADTdtfR;14;2222;10;4004;\u002d;]
      0:[0;Cu116g1eD0nDJXVYfc;10.174.251.215;33003;10.47.3.208;2717;tcp;\u002d;0.000009999999747378752;0;0;S0;-;-;0;S;2;88;0;0;\u002d;]
      0:[0;Ce04Gh1mMPOm3rqISa;10.164.94.120;35105;10.47.3.200;80;tcp;http;0.007877999916672707;312;238;RSTO;-;-;0;ShADTdtfR;10;1160;6;804;\u002d;]
      0:[0;CwU8Lp28ZZQynPpDhj;10.174.251.215;33005;10.47.6.20;10000;tcp;\u002d;0.0000009999999974752427;0;0;S0;-;-;0;S;2;88;0;0;\u002d;]
      0:[0;C7PDVJLhVP4fLsVA7;10.174.251.215;33003;10.47.21.80;543;tcp;\u002d;0.000004999999873689376;0;0;S0;-;-;0;S;2;88;0;0;\u002d;]
      0:[0;COGGtj2Cwfefi0qP8;10.164.94.120;33645;10.47.8.208;3389;tcp;\u002d;0.014783999882638454;147;19;RSTR;-;-;0;ShADTdtr;10;830;6;342;\u002d;]
      0:[0;CUYEpG3ODJt8S2OsZ9;10.174.251.215;33003;10.47.6.52;32768;tcp;\u002d;0.0000019999999949504854;0;0;S0;-;-;0;S;2;88;0;0;\u002d;]
      0:[0;C71Tbm4oCC2JjyksC9;10.174.251.215;33003;10.47.6.51;544;tcp;\u002d;0.0000009999999974752427;0;0;S0;-;-;0;S;2;88;0;0;\u002d;]
      0:[0;CYVCtF4B7oCHJJ5DJl;10.174.251.215;33004;10.47.6.20;2717;tcp;\u002d;0.0000019999999949504854;0;0;S0;-;-;0;S;2;88;0;0;\u002d;]
      0:[0;CkYZUQ1zZjpmWfFvt7;10.164.94.120;42789;10.47.3.200;80;tcp;http;0.005991999991238117;320;246;RSTO;-;-;0;ShADTdtfR;10;1176;6;820;\u002d;]
      0:[0;Cr9SEd2ts5WM8W6v2g;10.174.251.215;33004;10.47.6.10;2049;tcp;\u002d;0.000003999999989900971;0;0;S0;-;-;0;S;2;88;0;0;\u002d;]
      0:[0;CivYhH25TFUxlJGtmh;10.174.251.215;33003;10.47.2.30;8443;tcp;\u002d;0.0000019999999949504854;0;0;S0;-;-;0;S;2;88;0;0;\u002d;]
      0:[0;CtX7jB2TQmo5rvlrdl;10.174.251.215;33003;10.47.22.1;8443;tcp;\u002d;0.0000019999999949504854;0;0;S0;-;-;0;S;2;88;0;0;\u002d;]
      0:[0;CtEzUQ2M8Gnp4giiKg;10.164.94.120;46501;10.47.8.200;443;tcp;\u002d;0.000003000000106112566;0;0;RSTOS0;-;-;0;R;2;104;0;0;\u002d;]
      0:[0;CwCPJo4if84OLr8cGj;10.174.251.215;33003;10.47.24.1;2049;tcp;\u002d;0.0000009999999974752427;0;0;S0;-;-;0;S;2;88;0;0;\u002d;]
      0:[0;CTxFlx3UXA8W2kzZh;10.174.251.215;33003;10.47.6.208;5000;tcp;\u002d;0.000003000000106112566;0;0;S0;-;-;0;S;2;88;0;0;\u002d;]
      0:[0;CCxi3j2XrYtihqRq16;10.128.0.207;59777;10.47.30.10;443;tcp;\u002d;0.003840999910607934;0;0;S0;-;-;0;S;76;3344;0;0;\u002d;]
      0:[0;CZvc7V35SA8OtpPpR2;10.174.251.215;33004;10.47.6.52;6000;tcp;\u002d;0.0000009999999974752427;0;0;S0;-;-;0;S;2;88;0;0;\u002d;]
      0:[0;Cpr54u2BAwqeURe8sj;10.164.94.120;38167;10.47.3.200;80;tcp;http;0.004813999868929386;312;238;RSTO;-;-;0;ShADTdtfR;10;1160;6;804;\u002d;]
      0:[0;CjPNbx39hnwCDGAB55;10.174.251.215;33004;10.47.2.20;49153;tcp;\u002d;0.000003000000106112566;0;0;S0;-;-;0;S;2;88;0;0;\u002d;]
      0:[0;CeY6YD1z0Ixt5wNXHc;10.174.251.215;33004;10.47.23.25;8008;tcp;\u002d;0.000003000000106112566;0;0;S0;-;-;0;S;2;88;0;0;\u002d;]
      0:[0;CypwGj3gMPgwl88c6e;10.174.251.215;33003;10.47.6.100;1028;tcp;\u002d;0.000003000000106112566;0;0;S0;-;-;0;S;2;88;0;0;\u002d;]
      0:[0;Cdiyqr5qqNQVphTLc;10.174.251.215;33003;10.47.21.80;389;tcp;\u002d;0.0000019999999949504854;0;0;S0;-;-;0;S;2;88;0;0;\u002d;]
      0:[0;CUbL0i4rQ65MLNJQvl;10.174.251.215;33003;10.47.25.1;389;tcp;\u002d;0.0000019999999949504854;0;0;S0;-;-;0;S;2;88;0;0;\u002d;]
      0:[0;CfF0l04W6QcLEotJZk;10.164.94.120;37947;10.47.3.200;80;tcp;http;0.004976999945938587;316;242;RSTO;-;-;0;ShADTdtfR;10;1168;6;812;\u002d;]
      0:[0;CJsOw61Yox4GCSrwh6;10.164.94.120;45687;10.47.3.200;80;tcp;http;0.010127999819815159;302;223;RSTO;-;-;0;ShADTdtfR;10;1140;6;774;\u002d;]
      0:[0;CYnIt64hp7U7S6RCa5;10.164.94.120;45797;10.47.27.80;8080;tcp;http;0.02310599945485592;437;1382;RSTO;-;-;0;ShADTdtR;10;1410;4;2988;\u002d;]
      0:[0;Cw4m7DYEVGvtCtTgb;10.174.251.215;33004;10.47.2.30;9100;tcp;\u002d;0.0000009999999974752427;0;0;S0;-;-;0;S;2;88;0;0;\u002d;]
      0:[0;CbLivK30f9L4f6mMPd;10.174.251.215;33003;10.47.23.25;2000;tcp;\u002d;0.0000019999999949504854;0;0;S0;-;-;0;S;2;88;0;0;\u002d;]
      0:[0;CKNF4FdCFSzyIyIKg;10.174.251.215;33003;10.47.6.53;2049;tcp;\u002d;0.0000019999999949504854;0;0;S0;-;-;0;S;2;88;0;0;\u002d;]
      0:[0;CBhGAX24bS1iuP0fl9;10.164.94.120;32929;10.47.3.200;80;tcp;http;0.00841899961233139;313;239;RSTO;-;-;0;ShADTdtfR;10;1162;6;806;\u002d;]
      0:[0;CpZmOa2Igj7HRKyhZ1;10.164.94.120;43015;10.47.8.208;3389;tcp;\u002d;0.016114000231027603;147;19;RSTR;-;-;0;ShADTdtr;10;830;6;342;\u002d;]
      0:[0;CeAKWc4ZMVxRw5Q8d5;10.174.251.215;33003;10.47.2.208;2000;tcp;\u002d;0.000003000000106112566;0;0;S0;-;-;0;S;2;88;0;0;\u002d;]
      0:[0;Cawkmq1waixNyNCpRh;10.174.251.215;33004;10.47.25.80;389;tcp;\u002d;0.000003999999989900971;0;0;S0;-;-;0;S;2;88;0;0;\u002d;]
      0:[0;Csw5QS1PKUj8bbIjN4;10.174.251.215;33003;10.47.3.200;389;tcp;\u002d;0.0000019999999949504854;0;0;S0;-;-;0;S;2;88;0;0;\u002d;]
      0:[0;C8gX9A2CDixd7nR5we;10.174.251.215;33004;10.47.3.208;5000;tcp;\u002d;0.0000470000013592653;0;0;S0;-;-;0;S;2;88;0;0;\u002d;]
      0:[0;Cqww0K13IAdnKKDNTi;10.174.251.215;33003;10.47.25.80;544;tcp;\u002d;0.000003999999989900971;0;0;S0;-;-;0;S;2;88;0;0;\u002d;]
      0:[0;CaTQRB39zOCz7n8b26;10.174.251.215;33004;10.47.21.80;5357;tcp;\u002d;0.000003999999989900971;0;0;S0;-;-;0;S;2;88;0;0;\u002d;]
      0:[0;C29bQH2D34V2NP9hc3;10.174.251.215;33003;10.47.6.20;2000;tcp;\u002d;0.000006000000212225132;0;0;S0;-;-;0;S;2;88;0;0;\u002d;]
      0:[0;CMNwe92DFj1nBYNvSl;10.164.94.120;38749;10.47.3.200;80;tcp;http;0.004637999925762415;312;238;RSTO;-;-;0;ShADTdtfR;10;1160;6;804;\u002d;]
      0:[0;Ct3paF3E8YVkPU3ROb;10.174.251.215;33004;10.47.6.51;49153;tcp;\u002d;0.000003000000106112566;0;0;S0;-;-;0;S;2;88;0;0;\u002d;]
      0:[0;CpnYxymltzCpUmRQ8;10.174.251.215;33004;10.47.6.52;631;tcp;\u002d;0.0000009999999974752427;0;0;S0;-;-;0;S;2;88;0;0;\u002d;]
      0:[0;C11zLc1aUjX2b8gW8l;10.164.94.120;41335;10.47.3.218;80;tcp;\u002d;0.05964399874210358;302;1064;RSTOS0;-;-;0;^dtADTR;6;916;4;2336;\u002d;]
      0:[0;CgFV052fnJacNqc8c5;10.128.0.207;59778;10.47.31.4;443;tcp;\u002d;0.004033000208437443;0;0;S0;-;-;0;S;82;3608;0;0;\u002d;]
      0:[0;Ck0Eg42ju7yEZmKLC2;10.164.94.120;34259;10.47.8.200;443;tcp;ssl;0.008538000285625458;197;0;RSTO;-;-;0;ShADTfR;8;826;4;224;\u002d;]
      0:[0;CC35pe1n2m9PAt2f77;10.164.94.120;45895;10.47.3.200;80;tcp;http;0.005375999957323074;324;250;RSTO;-;-;0;ShADTdtfR;10;1184;6;828;\u002d;]
