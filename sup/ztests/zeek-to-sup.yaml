# If you change the test below after a change to make it pass, make sure the
# input/output are still in sync with what's at docs/integrations/zeek/data-type-compatibility.md.

script: super -f sup zeek_types.log

inputs:
  - name: zeek_types.log
    data: |
      #separator \x09
      #set_separator	,
      #empty_field	(empty)
      #unset_field	-
      #fields	my_bool	my_count	my_int	my_double	my_time	my_interval	my_printable_string	my_bytes_string	my_port	my_addr	my_subnet	my_enum	my_set	my_vector	my_record.name	my_record.age
      #types	bool	count	int	double	time	interval	string	string	port	addr	subnet	enum	set[string]	vector[string]	string	count
      T	123	456	123.4560	1592502151.123456	123.456	smile\xf0\x9f\x98\x81smile	\x09\x07\x04	80	127.0.0.1	10.0.0.0/8	tcp	things,in,a,set	order,is,important	Jeanne	122

outputs:
  - name: stdout
    data: |
      {
        my_bool: true::(bool|null),
        my_count: 123::uint64::(uint64|null),
        my_int: 456::(int64|null),
        my_double: 123.456::(float64|null),
        my_time: 2020-06-18T17:42:31.123456Z::(time|null),
        my_interval: 2m3.456s::(duration|null),
        my_printable_string: "smileüòÅsmile"::(string|null),
        my_bytes_string: "\t\u0007\u0004"::(string|null),
        my_port: 80::(port=uint16)::(port|null),
        my_addr: 127.0.0.1::(ip|null),
        my_subnet: 10.0.0.0/8::(net|null),
        my_enum: "tcp"::=zenum::(zenum|null),
        my_set: |[
          "a",
          "in",
          "set",
          "things"
        ]|::|[string|null]|::(null||[string|null]|),
        my_vector: [
          "order",
          "is",
          "important"
        ]::[string|null]::(null|[string|null]),
        my_record: {
          name: "Jeanne"::(string|null),
          age: 122::uint64::(uint64|null)
        }
      }
