script: |
  mkdir logs
  zar import -R logs multitype.tzng
  # ignore stdout here
  zar index create -R logs id.orig_h > trash
  # since index operation failed, no files should be left behind so this
  # ls command should have an empty output
  echo ===
  zar ls -R logs -ranges -l
  echo ===

inputs:
  - name: multitype.tzng
    data: |
      #0:record[_path:string,ts:time,id:record[orig_h:ip]]
      0:[smb_cmd;1258594907.85978;[192.168.2.1;]]
      #1:record[_path:string,ts:time,id:record[orig_h:string]]
      1:[smb_cmd;1258594907.85978;[192.168.2.1;]]


outputs:
  - name: stderr
    regexp: |
      type of id.orig_h field changed from string to ip
  - name: stdout
    data: |
      ===
      ===
