script: |
  mkdir logs
  zed lake import -R logs babble.zson
  zed lake map -R logs "count()" | zq -z -
  echo ===
  zed lake map -R logs -o count.zng "count()"
  zq -z "sum(count)" $(find ./logs -name count.zng)
  echo ===
  zed lake map -R logs -o top.zng "count() by v | sort -r count, v | head 1"
  zed lake map -R logs -o bottom.zng "count() by v | sort count, v | head 1"
  zed lake map -R logs -z "sort v" top.zng bottom.zng

inputs:
  - name: babble.zson
    source: ../../testdata/babble.zson

outputs:
  - name: stdout
    data: |
      {count:496 (uint64)} (=0)
      {count:504} (0)
      ===
      {sum:1000 (uint64)} (=0)
      ===
      {v:1,count:1 (uint64)} (=0)
      {v:278,count:6} (0)
      {v:1,count:1 (uint64)} (=0)
      {v:14,count:5} (0)
