# This test instantiates two Parquet readers on files with different
# schemas, ensuring that they properly share a Super type context.

script: |
  super conn.parquet dns.parquet | super - | super -s -

inputs:
  - name: conn.parquet
  - name: dns.parquet

outputs:
  - name: stdout
    data: |
      {_path:"conn"::(string|null),ts:1.521835183460591e+09::(float64|null),uid:"C1UTdt1Fx86IbcUyDl"::(string|null),id_orig_h:"10.147.172.39"::(string|null),id_orig_p:20620::(int64|null),id_resp_h:"10.47.1.54"::(string|null),id_resp_p:9815::(int64|null),proto:"tcp"::(string|null),duration:0.3108789920806885::(float64|null),orig_bytes:0::(int64|null),resp_bytes:0::(int64|null),conn_state:"REJ"::(string|null),missed_bytes:0::(int64|null),history:"Sr"::(string|null),orig_pkts:2::(int64|null),orig_ip_bytes:80::(int64|null),resp_pkts:2::(int64|null),resp_ip_bytes:80::(int64|null)}
      {_path:"conn"::(string|null),ts:1.521835182341333e+09::(float64|null),uid:"CEOJpRC23AYij2hWh"::(string|null),id_orig_h:"10.237.102.3"::(string|null),id_orig_p:11344::(int64|null),id_resp_h:"10.47.1.51"::(string|null),id_resp_p:180::(int64|null),proto:"tcp"::(string|null),duration:0.32901906967163086::(float64|null),orig_bytes:0::(int64|null),resp_bytes:0::(int64|null),conn_state:"REJ"::(string|null),missed_bytes:0::(int64|null),history:"Sr"::(string|null),orig_pkts:2::(int64|null),orig_ip_bytes:80::(int64|null),resp_pkts:2::(int64|null),resp_ip_bytes:80::(int64|null)}
      {_path:"conn"::(string|null),ts:1.521835183521865e+09::(float64|null),uid:"CSVS9y2f3guBsMJTc9"::(string|null),id_orig_h:"10.147.172.39"::(string|null),id_orig_p:23380::(int64|null),id_resp_h:"10.47.1.208"::(string|null),id_resp_p:6764::(int64|null),proto:"tcp"::(string|null),duration:0.0002830028533935547::(float64|null),orig_bytes:0::(int64|null),resp_bytes:0::(int64|null),conn_state:"REJ"::(string|null),missed_bytes:0::(int64|null),history:"Sr"::(string|null),orig_pkts:2::(int64|null),orig_ip_bytes:80::(int64|null),resp_pkts:2::(int64|null),resp_ip_bytes:80::(int64|null)}
      {_path:"conn"::(string|null),ts:1.521835180202843e+09::(float64|null),uid:"CxUBl02PHFE4G8CFwj"::(string|null),id_orig_h:"10.237.102.3"::(string|null),id_orig_p:13733::(int64|null),id_resp_h:"10.47.1.55"::(string|null),id_resp_p:4957::(int64|null),proto:"tcp"::(string|null),duration:0.0018019676208496094::(float64|null),orig_bytes:0::(int64|null),resp_bytes:0::(int64|null),conn_state:"REJ"::(string|null),missed_bytes:0::(int64|null),history:"Sr"::(string|null),orig_pkts:2::(int64|null),orig_ip_bytes:80::(int64|null),resp_pkts:2::(int64|null),resp_ip_bytes:80::(int64|null)}
      {_path:"conn"::(string|null),ts:1.521835183809758e+09::(float64|null),uid:"CLunkV2xqhVX9LMn0d"::(string|null),id_orig_h:"10.147.172.39"::(string|null),id_orig_p:20464::(int64|null),id_resp_h:"10.47.1.30"::(string|null),id_resp_p:6766::(int64|null),proto:"tcp"::(string|null),duration:0.00034499168395996094::(float64|null),orig_bytes:0::(int64|null),resp_bytes:0::(int64|null),conn_state:"REJ"::(string|null),missed_bytes:0::(int64|null),history:"Sr"::(string|null),orig_pkts:2::(int64|null),orig_ip_bytes:80::(int64|null),resp_pkts:2::(int64|null),resp_ip_bytes:80::(int64|null)}
      {_path:"conn"::(string|null),ts:1.521835182596165e+09::(float64|null),uid:"C5s4IN2WPL7u8leUxi"::(string|null),id_orig_h:"10.237.102.3"::(string|null),id_orig_p:14389::(int64|null),id_resp_h:"10.47.1.54"::(string|null),id_resp_p:3607::(int64|null),proto:"tcp"::(string|null),duration:0.312701940536499::(float64|null),orig_bytes:0::(int64|null),resp_bytes:0::(int64|null),conn_state:"REJ"::(string|null),missed_bytes:0::(int64|null),history:"Sr"::(string|null),orig_pkts:2::(int64|null),orig_ip_bytes:80::(int64|null),resp_pkts:2::(int64|null),resp_ip_bytes:80::(int64|null)}
      {_path:"conn"::(string|null),ts:1.521835181975703e+09::(float64|null),uid:"CINcYi3FsUWz1FNHVg"::(string|null),id_orig_h:"10.237.102.3"::(string|null),id_orig_p:17476::(int64|null),id_resp_h:"10.47.1.208"::(string|null),id_resp_p:2629::(int64|null),proto:"tcp"::(string|null),duration:0.00018596649169921875::(float64|null),orig_bytes:0::(int64|null),resp_bytes:0::(int64|null),conn_state:"REJ"::(string|null),missed_bytes:0::(int64|null),history:"Sr"::(string|null),orig_pkts:2::(int64|null),orig_ip_bytes:80::(int64|null),resp_pkts:2::(int64|null),resp_ip_bytes:80::(int64|null)}
      {_path:"conn"::(string|null),ts:1.521835182221383e+09::(float64|null),uid:"CERIDN1klQYEa6EGid"::(string|null),id_orig_h:"10.147.172.39"::(string|null),id_orig_p:26422::(int64|null),id_resp_h:"10.47.1.50"::(string|null),id_resp_p:6947::(int64|null),proto:"tcp"::(string|null),duration:0.29776597023010254::(float64|null),orig_bytes:0::(int64|null),resp_bytes:0::(int64|null),conn_state:"REJ"::(string|null),missed_bytes:0::(int64|null),history:"Sr"::(string|null),orig_pkts:2::(int64|null),orig_ip_bytes:80::(int64|null),resp_pkts:2::(int64|null),resp_ip_bytes:80::(int64|null)}
      {_path:"conn"::(string|null),ts:1.521835183092898e+09::(float64|null),uid:"CcHHMD4wopPMgw7x77"::(string|null),id_orig_h:"10.147.172.39"::(string|null),id_orig_p:20663::(int64|null),id_resp_h:"10.47.1.200"::(string|null),id_resp_p:5804::(int64|null),proto:"tcp"::(string|null),duration:0.0005340576171875::(float64|null),orig_bytes:0::(int64|null),resp_bytes:0::(int64|null),conn_state:"REJ"::(string|null),missed_bytes:0::(int64|null),history:"Sr"::(string|null),orig_pkts:2::(int64|null),orig_ip_bytes:80::(int64|null),resp_pkts:2::(int64|null),resp_ip_bytes:80::(int64|null)}
      {_path:"conn"::(string|null),ts:1.521835183311316e+09::(float64|null),uid:"CJK50b14RtQUHMRGw"::(string|null),id_orig_h:"10.147.172.39"::(string|null),id_orig_p:22283::(int64|null),id_resp_h:"10.47.1.53"::(string|null),id_resp_p:5321::(int64|null),proto:"tcp"::(string|null),duration:0.26862287521362305::(float64|null),orig_bytes:0::(int64|null),resp_bytes:0::(int64|null),conn_state:"REJ"::(string|null),missed_bytes:0::(int64|null),history:"Sr"::(string|null),orig_pkts:2::(int64|null),orig_ip_bytes:80::(int64|null),resp_pkts:2::(int64|null),resp_ip_bytes:80::(int64|null)}
      {_path:"dns"::(string|null),ts:1.521835132679404e+09::(float64|null),uid:"ComhFoZjBuWcQPpo1"::(string|null),id_orig_h:"10.47.6.100"::(string|null),id_orig_p:41414::(int64|null),id_resp_h:"10.0.0.100"::(string|null),id_resp_p:53::(int64|null),proto:"udp"::(string|null),trans_id:3186::(int64|null),rtt:0.0009949207305908203::(float64|null),query:"safebrowsing-cache.google.com"::(string|null),qclass:1::(int64|null),qclass_name:"C_INTERNET"::(string|null),qtype:1::(int64|null),qtype_name:"A"::(string|null),rcode:0::(int64|null),rcode_name:"NOERROR"::(string|null),AA:false::(bool|null),TC:false::(bool|null),RD:true::(bool|null),RA:true::(bool|null),Z:0::(int64|null),answers:["safebrowsing.cache.l.google.com","172.217.11.78"]::(null|[string]),TTLs:[21285.,15.]::(null|[float64]),rejected:false::(bool|null)}
      {_path:"dns"::(string|null),ts:1.521835132683496e+09::(float64|null),uid:"C5DkgGjFsWMz4uZR1"::(string|null),id_orig_h:"10.47.6.1"::(string|null),id_orig_p:54824::(int64|null),id_resp_h:"10.0.0.100"::(string|null),id_resp_p:53::(int64|null),proto:"udp"::(string|null),trans_id:9946::(int64|null),rtt:0.0009438991546630859::(float64|null),query:"3c5ce1fc426f25e1d930b2939f7d379f.clo.footprintdns.com"::(string|null),qclass:1::(int64|null),qclass_name:"C_INTERNET"::(string|null),qtype:1::(int64|null),qtype_name:"A"::(string|null),rcode:0::(int64|null),rcode_name:"NOERROR"::(string|null),AA:false::(bool|null),TC:false::(bool|null),RD:true::(bool|null),RA:true::(bool|null),Z:0::(int64|null),answers:["pn1prdapp01-canary.cloudapp.net","104.211.96.15"]::(null|[string]),TTLs:[168.,168.]::(null|[float64]),rejected:false::(bool|null)}
      {_path:"dns"::(string|null),ts:1.521835132687034e+09::(float64|null),uid:"CCBR083sDelBR3qkt7"::(string|null),id_orig_h:"10.47.6.100"::(string|null),id_orig_p:42342::(int64|null),id_resp_h:"10.0.0.100"::(string|null),id_resp_p:53::(int64|null),proto:"udp"::(string|null),trans_id:13838::(int64|null),rtt:0.001190185546875::(float64|null),query:"safebrowsing-cache.google.com"::(string|null),qclass:1::(int64|null),qclass_name:"C_INTERNET"::(string|null),qtype:1::(int64|null),qtype_name:"A"::(string|null),rcode:0::(int64|null),rcode_name:"NOERROR"::(string|null),AA:false::(bool|null),TC:false::(bool|null),RD:true::(bool|null),RA:true::(bool|null),Z:0::(int64|null),answers:["safebrowsing.cache.l.google.com","172.217.11.78"]::(null|[string]),TTLs:[21285.,15.]::(null|[float64]),rejected:false::(bool|null)}
      {_path:"dns"::(string|null),ts:1.521835132694368e+09::(float64|null),uid:"CxaTjX3OwO7J1QcnQd"::(string|null),id_orig_h:"10.47.6.100"::(string|null),id_orig_p:38177::(int64|null),id_resp_h:"10.0.0.100"::(string|null),id_resp_p:53::(int64|null),proto:"udp"::(string|null),trans_id:8919::(int64|null),rtt:0.0009741783142089844::(float64|null),query:"safebrowsing-cache.google.com"::(string|null),qclass:1::(int64|null),qclass_name:"C_INTERNET"::(string|null),qtype:1::(int64|null),qtype_name:"A"::(string|null),rcode:0::(int64|null),rcode_name:"NOERROR"::(string|null),AA:false::(bool|null),TC:false::(bool|null),RD:true::(bool|null),RA:true::(bool|null),Z:0::(int64|null),answers:["safebrowsing.cache.l.google.com","172.217.11.78"]::(null|[string]),TTLs:[21285.,15.]::(null|[float64]),rejected:false::(bool|null)}
      {_path:"dns"::(string|null),ts:1.521835132694375e+09::(float64|null),uid:"CxaTjX3OwO7J1QcnQd"::(string|null),id_orig_h:"10.47.6.100"::(string|null),id_orig_p:38177::(int64|null),id_resp_h:"10.0.0.100"::(string|null),id_resp_p:53::(int64|null),proto:"udp"::(string|null),trans_id:30814::(int64|null),rtt:0.0012099742889404297::(float64|null),query:"safebrowsing-cache.google.com"::(string|null),qclass:1::(int64|null),qclass_name:"C_INTERNET"::(string|null),qtype:28::(int64|null),qtype_name:"AAAA"::(string|null),rcode:0::(int64|null),rcode_name:"NOERROR"::(string|null),AA:false::(bool|null),TC:false::(bool|null),RD:true::(bool|null),RA:true::(bool|null),Z:0::(int64|null),answers:["safebrowsing.cache.l.google.com","2607:f8b0:4007:802::200e"]::(null|[string]),TTLs:[21285.,15.]::(null|[float64]),rejected:false::(bool|null)}
      {_path:"dns"::(string|null),ts:1.52183513270122e+09::(float64|null),uid:"CTfdsI1ic7A49cqfg"::(string|null),id_orig_h:"10.47.6.100"::(string|null),id_orig_p:39106::(int64|null),id_resp_h:"10.0.0.100"::(string|null),id_resp_p:53::(int64|null),proto:"udp"::(string|null),trans_id:26085::(int64|null),rtt:0.001110076904296875::(float64|null),query:"safebrowsing-cache.google.com"::(string|null),qclass:1::(int64|null),qclass_name:"C_INTERNET"::(string|null),qtype:28::(int64|null),qtype_name:"AAAA"::(string|null),rcode:0::(int64|null),rcode_name:"NOERROR"::(string|null),AA:false::(bool|null),TC:false::(bool|null),RD:true::(bool|null),RA:true::(bool|null),Z:0::(int64|null),answers:["safebrowsing.cache.l.google.com","2607:f8b0:4007:802::200e"]::(null|[string]),TTLs:[21285.,15.]::(null|[float64]),rejected:false::(bool|null)}
      {_path:"dns"::(string|null),ts:1.521835132708956e+09::(float64|null),uid:"CdipbQ1a78u2o2iPek"::(string|null),id_orig_h:"10.47.6.100"::(string|null),id_orig_p:41359::(int64|null),id_resp_h:"10.0.0.100"::(string|null),id_resp_p:53::(int64|null),proto:"udp"::(string|null),trans_id:15482::(int64|null),rtt:0.0012309551239013672::(float64|null),query:"safebrowsing-cache.google.com"::(string|null),qclass:1::(int64|null),qclass_name:"C_INTERNET"::(string|null),qtype:1::(int64|null),qtype_name:"A"::(string|null),rcode:0::(int64|null),rcode_name:"NOERROR"::(string|null),AA:false::(bool|null),TC:false::(bool|null),RD:true::(bool|null),RA:true::(bool|null),Z:0::(int64|null),answers:["safebrowsing.cache.l.google.com","172.217.11.78"]::(null|[string]),TTLs:[21285.,15.]::(null|[float64]),rejected:false::(bool|null)}
      {_path:"dns"::(string|null),ts:1.521835132715721e+09::(float64|null),uid:"CR9mu51N6DGgkB457c"::(string|null),id_orig_h:"10.47.6.100"::(string|null),id_orig_p:50552::(int64|null),id_resp_h:"10.0.0.100"::(string|null),id_resp_p:53::(int64|null),proto:"udp"::(string|null),trans_id:61933::(int64|null),rtt:0.0013020038604736328::(float64|null),query:"safebrowsing-cache.google.com"::(string|null),qclass:1::(int64|null),qclass_name:"C_INTERNET"::(string|null),qtype:1::(int64|null),qtype_name:"A"::(string|null),rcode:0::(int64|null),rcode_name:"NOERROR"::(string|null),AA:false::(bool|null),TC:false::(bool|null),RD:true::(bool|null),RA:true::(bool|null),Z:0::(int64|null),answers:["safebrowsing.cache.l.google.com","172.217.11.78"]::(null|[string]),TTLs:[21285.,15.]::(null|[float64]),rejected:false::(bool|null)}
      {_path:"dns"::(string|null),ts:1.521835132715729e+09::(float64|null),uid:"CR9mu51N6DGgkB457c"::(string|null),id_orig_h:"10.47.6.100"::(string|null),id_orig_p:50552::(int64|null),id_resp_h:"10.0.0.100"::(string|null),id_resp_p:53::(int64|null),proto:"udp"::(string|null),trans_id:49414::(int64|null),rtt:0.0013010501861572266::(float64|null),query:"safebrowsing-cache.google.com"::(string|null),qclass:1::(int64|null),qclass_name:"C_INTERNET"::(string|null),qtype:28::(int64|null),qtype_name:"AAAA"::(string|null),rcode:0::(int64|null),rcode_name:"NOERROR"::(string|null),AA:false::(bool|null),TC:false::(bool|null),RD:true::(bool|null),RA:true::(bool|null),Z:0::(int64|null),answers:["safebrowsing.cache.l.google.com","2607:f8b0:4007:802::200e"]::(null|[string]),TTLs:[21285.,15.]::(null|[float64]),rejected:false::(bool|null)}
      {_path:"dns"::(string|null),ts:1.521835132740816e+09::(float64|null),uid:"C8FlTH3eX5boHTem7"::(string|null),id_orig_h:"10.47.6.100"::(string|null),id_orig_p:42492::(int64|null),id_resp_h:"10.0.0.100"::(string|null),id_resp_p:53::(int64|null),proto:"udp"::(string|null),trans_id:35043::(int64|null),rtt:0.0013527870178222656::(float64|null),query:"safebrowsing-cache.google.com"::(string|null),qclass:1::(int64|null),qclass_name:"C_INTERNET"::(string|null),qtype:28::(int64|null),qtype_name:"AAAA"::(string|null),rcode:0::(int64|null),rcode_name:"NOERROR"::(string|null),AA:false::(bool|null),TC:false::(bool|null),RD:true::(bool|null),RA:true::(bool|null),Z:0::(int64|null),answers:["safebrowsing.cache.l.google.com","2607:f8b0:4007:802::200e"]::(null|[string]),TTLs:[21285.,15.]::(null|[float64]),rejected:false::(bool|null)}
