spq: values map(this,&upper)

vector: true

input: |
  ["foo","bar",null]
  |["foo","bar",null]|
  "invalid"
  null

output: |
  ["FOO","BAR",null]
  |[null,"BAR","FOO"]|
  error({message:"map: expected array or set value",on:"invalid"})
  null
  
---

# Test UDF.
spq: |
  fn castInt(v): (v::int64)
  values map(this, &castInt)

vector: true

input: | 
  ["1","2","foo"]

output: |
  [1,2,error({message:"cannot cast to int64",on:"foo"})]
