script: |
  export ZED_LAKE=test
  zed init -q
  zed create -q -orderby ts test
  # At the time of writing, the where operator is necessary because a pool scan
  # is parallelized only when followed by another operator.
  zc -C -P 2 "from test | join (from test | where true) on a=b" | sed -e 's/pool .*/.../'

outputs:
  - name: stdout
    data: |
      lister ...
      | slicer
      | scatter (
        =>
          seqscan ...
        =>
          seqscan ...
      )
      | merge ts:asc
      | fork (
        =>
          pass
        =>
          lister ...
          | slicer
          | scatter (
            =>
              seqscan ...
            =>
              seqscan ...
          )
          | merge ts:asc
      )
      | join on a=b
