script: |
  source service.sh
  zapi create -q test
  zapi load -q -use test@main in.zson
  curl -X POST \
    -H "Accept: application/x-zng" \
    -d '{"query": "from test"}' \
    $ZED_LAKE/query?noctrl=t

inputs:
  - name: service.sh
  - name: in.zson
    # This ZSON produces ZNG output containing a compressed value
    # message block.
    data: |
      {a:"aaaaaaaaaaaaaaa",b:"aaaaaaaaaaaaaaa"}

outputs:
  - name: stdout
    # Generated with
    # `bash -c 'zq - <<<{a:\"aaaaaaaaaaaaaaa\",b:\"aaaaaaaaaaaaaaa\"} | base64'`.
    data: !!binary |
      9gIBYRABYhD9ACIXShcgIGEBAAAQAMBhYWFhYWFhYWFhYWH/
