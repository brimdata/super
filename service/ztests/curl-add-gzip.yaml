script: |
  source service.sh
  curl -X POST -d '{"name":"test"}' http://$ZED_LAKE_HOST/pool > pool.json
  poolID=$(zq -f text "cut value.pool.id" pool.json)
  branchID=$(zq -f text "cut value.branch.id" pool.json)
  curl -X POST --data-binary @- http://$ZED_LAKE_HOST/pool/$poolID/$branchID

inputs:
  - name: stdin
    # Generated with `bash -c 'gzip -c <<<{x:1} | base64'`.
    data: !!binary |
      H4sIAMaiGmEAA6uusDKs5QIAaI7+2QYAAAA=
  - name: service.sh
    source: service.sh

outputs:
  - name: stdout
    regexp: |
      {"kind":"CommitResponse","value":{"commit":"0x\w{40}","warnings":\[]}}
