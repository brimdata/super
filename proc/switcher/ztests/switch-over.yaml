zed: |
  switch (
    case len(a)==3 => over a | sum(this)
    default => over a | yield {b:this}
  ) | sort this

input: |
  {a:[1,2,3]}
  {a:[6,7,8,9]}
  {a:[4,5,6]}

output: |
  {b:6}
  {b:7}
  {b:8}
  {b:9}
  {sum:6}
  {sum:15}
