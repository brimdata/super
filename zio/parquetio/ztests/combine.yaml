# This test instantiates two Parquet readers on files with different
# schemas, ensuring that they properly share a ZNG type context.

script: |
  zq conn.parquet dns.parquet | zq -z -

inputs:
  - name: conn.parquet
  - name: dns.parquet

outputs:
  - name: stdout
    data: |
      {_path:"conn",ts:1.521835183460591e+09,uid:"C1UTdt1Fx86IbcUyDl",id_orig_h:"10.147.172.39",id_orig_p:20620,id_resp_h:"10.47.1.54",id_resp_p:9815,proto:"tcp",duration:0.3108789920806885,orig_bytes:0,resp_bytes:0,conn_state:"REJ",missed_bytes:0,history:"Sr",orig_pkts:2,orig_ip_bytes:80,resp_pkts:2,resp_ip_bytes:80}
      {_path:"conn",ts:1.521835182341333e+09,uid:"CEOJpRC23AYij2hWh",id_orig_h:"10.237.102.3",id_orig_p:11344,id_resp_h:"10.47.1.51",id_resp_p:180,proto:"tcp",duration:0.32901906967163086,orig_bytes:0,resp_bytes:0,conn_state:"REJ",missed_bytes:0,history:"Sr",orig_pkts:2,orig_ip_bytes:80,resp_pkts:2,resp_ip_bytes:80}
      {_path:"conn",ts:1.521835183521865e+09,uid:"CSVS9y2f3guBsMJTc9",id_orig_h:"10.147.172.39",id_orig_p:23380,id_resp_h:"10.47.1.208",id_resp_p:6764,proto:"tcp",duration:0.0002830028533935547,orig_bytes:0,resp_bytes:0,conn_state:"REJ",missed_bytes:0,history:"Sr",orig_pkts:2,orig_ip_bytes:80,resp_pkts:2,resp_ip_bytes:80}
      {_path:"conn",ts:1.521835180202843e+09,uid:"CxUBl02PHFE4G8CFwj",id_orig_h:"10.237.102.3",id_orig_p:13733,id_resp_h:"10.47.1.55",id_resp_p:4957,proto:"tcp",duration:0.0018019676208496094,orig_bytes:0,resp_bytes:0,conn_state:"REJ",missed_bytes:0,history:"Sr",orig_pkts:2,orig_ip_bytes:80,resp_pkts:2,resp_ip_bytes:80}
      {_path:"conn",ts:1.521835183809758e+09,uid:"CLunkV2xqhVX9LMn0d",id_orig_h:"10.147.172.39",id_orig_p:20464,id_resp_h:"10.47.1.30",id_resp_p:6766,proto:"tcp",duration:0.00034499168395996094,orig_bytes:0,resp_bytes:0,conn_state:"REJ",missed_bytes:0,history:"Sr",orig_pkts:2,orig_ip_bytes:80,resp_pkts:2,resp_ip_bytes:80}
      {_path:"conn",ts:1.521835182596165e+09,uid:"C5s4IN2WPL7u8leUxi",id_orig_h:"10.237.102.3",id_orig_p:14389,id_resp_h:"10.47.1.54",id_resp_p:3607,proto:"tcp",duration:0.312701940536499,orig_bytes:0,resp_bytes:0,conn_state:"REJ",missed_bytes:0,history:"Sr",orig_pkts:2,orig_ip_bytes:80,resp_pkts:2,resp_ip_bytes:80}
      {_path:"conn",ts:1.521835181975703e+09,uid:"CINcYi3FsUWz1FNHVg",id_orig_h:"10.237.102.3",id_orig_p:17476,id_resp_h:"10.47.1.208",id_resp_p:2629,proto:"tcp",duration:0.00018596649169921875,orig_bytes:0,resp_bytes:0,conn_state:"REJ",missed_bytes:0,history:"Sr",orig_pkts:2,orig_ip_bytes:80,resp_pkts:2,resp_ip_bytes:80}
      {_path:"conn",ts:1.521835182221383e+09,uid:"CERIDN1klQYEa6EGid",id_orig_h:"10.147.172.39",id_orig_p:26422,id_resp_h:"10.47.1.50",id_resp_p:6947,proto:"tcp",duration:0.29776597023010254,orig_bytes:0,resp_bytes:0,conn_state:"REJ",missed_bytes:0,history:"Sr",orig_pkts:2,orig_ip_bytes:80,resp_pkts:2,resp_ip_bytes:80}
      {_path:"conn",ts:1.521835183092898e+09,uid:"CcHHMD4wopPMgw7x77",id_orig_h:"10.147.172.39",id_orig_p:20663,id_resp_h:"10.47.1.200",id_resp_p:5804,proto:"tcp",duration:0.0005340576171875,orig_bytes:0,resp_bytes:0,conn_state:"REJ",missed_bytes:0,history:"Sr",orig_pkts:2,orig_ip_bytes:80,resp_pkts:2,resp_ip_bytes:80}
      {_path:"conn",ts:1.521835183311316e+09,uid:"CJK50b14RtQUHMRGw",id_orig_h:"10.147.172.39",id_orig_p:22283,id_resp_h:"10.47.1.53",id_resp_p:5321,proto:"tcp",duration:0.26862287521362305,orig_bytes:0,resp_bytes:0,conn_state:"REJ",missed_bytes:0,history:"Sr",orig_pkts:2,orig_ip_bytes:80,resp_pkts:2,resp_ip_bytes:80}
      {_path:"dns",ts:1.521835132679404e+09,uid:"ComhFoZjBuWcQPpo1",id_orig_h:"10.47.6.100",id_orig_p:41414,id_resp_h:"10.0.0.100",id_resp_p:53,proto:"udp",trans_id:3186,rtt:0.0009949207305908203,query:"safebrowsing-cache.google.com",qclass:1,qclass_name:"C_INTERNET",qtype:1,qtype_name:"A",rcode:0,rcode_name:"NOERROR",AA:false,TC:false,RD:true,RA:true,Z:0,answers:["safebrowsing.cache.l.google.com","172.217.11.78"],TTLs:[21285.,15.],rejected:false}
      {_path:"dns",ts:1.521835132683496e+09,uid:"C5DkgGjFsWMz4uZR1",id_orig_h:"10.47.6.1",id_orig_p:54824,id_resp_h:"10.0.0.100",id_resp_p:53,proto:"udp",trans_id:9946,rtt:0.0009438991546630859,query:"3c5ce1fc426f25e1d930b2939f7d379f.clo.footprintdns.com",qclass:1,qclass_name:"C_INTERNET",qtype:1,qtype_name:"A",rcode:0,rcode_name:"NOERROR",AA:false,TC:false,RD:true,RA:true,Z:0,answers:["pn1prdapp01-canary.cloudapp.net","104.211.96.15"],TTLs:[168.,168.],rejected:false}
      {_path:"dns",ts:1.521835132687034e+09,uid:"CCBR083sDelBR3qkt7",id_orig_h:"10.47.6.100",id_orig_p:42342,id_resp_h:"10.0.0.100",id_resp_p:53,proto:"udp",trans_id:13838,rtt:0.001190185546875,query:"safebrowsing-cache.google.com",qclass:1,qclass_name:"C_INTERNET",qtype:1,qtype_name:"A",rcode:0,rcode_name:"NOERROR",AA:false,TC:false,RD:true,RA:true,Z:0,answers:["safebrowsing.cache.l.google.com","172.217.11.78"],TTLs:[21285.,15.],rejected:false}
      {_path:"dns",ts:1.521835132694368e+09,uid:"CxaTjX3OwO7J1QcnQd",id_orig_h:"10.47.6.100",id_orig_p:38177,id_resp_h:"10.0.0.100",id_resp_p:53,proto:"udp",trans_id:8919,rtt:0.0009741783142089844,query:"safebrowsing-cache.google.com",qclass:1,qclass_name:"C_INTERNET",qtype:1,qtype_name:"A",rcode:0,rcode_name:"NOERROR",AA:false,TC:false,RD:true,RA:true,Z:0,answers:["safebrowsing.cache.l.google.com","172.217.11.78"],TTLs:[21285.,15.],rejected:false}
      {_path:"dns",ts:1.521835132694375e+09,uid:"CxaTjX3OwO7J1QcnQd",id_orig_h:"10.47.6.100",id_orig_p:38177,id_resp_h:"10.0.0.100",id_resp_p:53,proto:"udp",trans_id:30814,rtt:0.0012099742889404297,query:"safebrowsing-cache.google.com",qclass:1,qclass_name:"C_INTERNET",qtype:28,qtype_name:"AAAA",rcode:0,rcode_name:"NOERROR",AA:false,TC:false,RD:true,RA:true,Z:0,answers:["safebrowsing.cache.l.google.com","2607:f8b0:4007:802::200e"],TTLs:[21285.,15.],rejected:false}
      {_path:"dns",ts:1.52183513270122e+09,uid:"CTfdsI1ic7A49cqfg",id_orig_h:"10.47.6.100",id_orig_p:39106,id_resp_h:"10.0.0.100",id_resp_p:53,proto:"udp",trans_id:26085,rtt:0.001110076904296875,query:"safebrowsing-cache.google.com",qclass:1,qclass_name:"C_INTERNET",qtype:28,qtype_name:"AAAA",rcode:0,rcode_name:"NOERROR",AA:false,TC:false,RD:true,RA:true,Z:0,answers:["safebrowsing.cache.l.google.com","2607:f8b0:4007:802::200e"],TTLs:[21285.,15.],rejected:false}
      {_path:"dns",ts:1.521835132708956e+09,uid:"CdipbQ1a78u2o2iPek",id_orig_h:"10.47.6.100",id_orig_p:41359,id_resp_h:"10.0.0.100",id_resp_p:53,proto:"udp",trans_id:15482,rtt:0.0012309551239013672,query:"safebrowsing-cache.google.com",qclass:1,qclass_name:"C_INTERNET",qtype:1,qtype_name:"A",rcode:0,rcode_name:"NOERROR",AA:false,TC:false,RD:true,RA:true,Z:0,answers:["safebrowsing.cache.l.google.com","172.217.11.78"],TTLs:[21285.,15.],rejected:false}
      {_path:"dns",ts:1.521835132715721e+09,uid:"CR9mu51N6DGgkB457c",id_orig_h:"10.47.6.100",id_orig_p:50552,id_resp_h:"10.0.0.100",id_resp_p:53,proto:"udp",trans_id:61933,rtt:0.0013020038604736328,query:"safebrowsing-cache.google.com",qclass:1,qclass_name:"C_INTERNET",qtype:1,qtype_name:"A",rcode:0,rcode_name:"NOERROR",AA:false,TC:false,RD:true,RA:true,Z:0,answers:["safebrowsing.cache.l.google.com","172.217.11.78"],TTLs:[21285.,15.],rejected:false}
      {_path:"dns",ts:1.521835132715729e+09,uid:"CR9mu51N6DGgkB457c",id_orig_h:"10.47.6.100",id_orig_p:50552,id_resp_h:"10.0.0.100",id_resp_p:53,proto:"udp",trans_id:49414,rtt:0.0013010501861572266,query:"safebrowsing-cache.google.com",qclass:1,qclass_name:"C_INTERNET",qtype:28,qtype_name:"AAAA",rcode:0,rcode_name:"NOERROR",AA:false,TC:false,RD:true,RA:true,Z:0,answers:["safebrowsing.cache.l.google.com","2607:f8b0:4007:802::200e"],TTLs:[21285.,15.],rejected:false}
      {_path:"dns",ts:1.521835132740816e+09,uid:"C8FlTH3eX5boHTem7",id_orig_h:"10.47.6.100",id_orig_p:42492,id_resp_h:"10.0.0.100",id_resp_p:53,proto:"udp",trans_id:35043,rtt:0.0013527870178222656,query:"safebrowsing-cache.google.com",qclass:1,qclass_name:"C_INTERNET",qtype:28,qtype_name:"AAAA",rcode:0,rcode_name:"NOERROR",AA:false,TC:false,RD:true,RA:true,Z:0,answers:["safebrowsing.cache.l.google.com","2607:f8b0:4007:802::200e"],TTLs:[21285.,15.],rejected:false}
